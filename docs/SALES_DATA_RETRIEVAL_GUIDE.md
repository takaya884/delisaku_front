# 売上チャネル データ自動取得ガイド

## 概要

このドキュメントは、37種類の売上チャネルから日次売上データを自動取得する方法を説明します。

## 対応チャネル一覧

### 店内販売（7チャネル）

#### 1. POSレジシステム（クラウド型）
- **データ取得方法**: API連携
- **対応サービス**: スマレジ、Airレジ、Square、ユビレジ等
- **実装手順**:
  1. 各POSサービスの管理画面からAPIキーを取得
  2. OAuth2.0認証を設定
  3. APIエンドポイント: `/api/pos/sales/daily`
  4. 日次バッチ処理で自動取得（例: 毎日午前2時）
- **データ形式**: JSON
- **取得内容**: 売上金額、取引件数、時間帯別売上等

#### 2. POSレジシステム（オンプレミス型）
- **データ取得方法**: CSV取り込み
- **実装手順**:
  1. POSシステムの日次CSVエクスポート機能を有効化
  2. 共有フォルダまたはFTP/SFTPサーバーにエクスポート
  3. ファイル監視プログラムで自動検知
  4. CSVパーサーでデータベースに取り込み
- **CSVフォーマット**: 日付,売上金額,取引件数,支払方法,等

#### 3. セルフレジ
- **データ取得方法**: API連携
- **実装手順**:
  1. セルフレジ管理サーバーのREST APIを利用
  2. APIエンドポイント: `/api/self-checkout/sales`
  3. リアルタイム連携も可能
- **備考**: 取引完了時にWebhookで即時反映も可能

#### 4. 手売り（現金レジスター・手動記帳）
- **データ取得方法**: 手動入力
- **実装手順**:
  1. 営業終了後に管理画面から入力
  2. モバイル対応の入力フォームを提供
  3. 日付、売上金額、取引件数を入力
- **備考**: レジ締め作業時にスマートフォンから入力可能

#### 5. 券売機（食券販売機）
- **データ取得方法**: CSV取り込み
- **実装手順**:
  1. 券売機管理ソフトから日次CSVエクスポート
  2. FTP/SFTP経由で自動転送
  3. 自動取り込みバッチ処理
- **CSVフォーマット**: 日付,商品名,金額,枚数,等

#### 6. タブレットオーダーシステム
- **データ取得方法**: API連携
- **実装手順**:
  1. タブレットオーダーシステムのAPI認証
  2. APIエンドポイント: `/api/tablet-order/sales`
  3. 日次バッチまたはリアルタイム取得
- **備考**: 注文データと連動して売上を集計

#### 7. モバイルオーダー（店内QRコード注文）
- **データ取得方法**: API連携
- **実装手順**:
  1. QRコード注文システムのWebhook設定
  2. APIエンドポイント: `/api/mobile-order/instore/sales`
  3. 注文完了時にリアルタイム通知
- **備考**: 決済完了時点で売上計上

---

### 決済手段別（7チャネル）

#### 8. クレジットカード決済端末（独立型）
- **データ取得方法**: API連携
- **対応サービス**: GMOペイメント、PAY.JP、ROBOT PAYMENT等
- **実装手順**:
  1. 決済代行会社のAPI認証
  2. APIエンドポイント: `/api/payment/credit/transactions`
  3. 日次売上レポート取得
- **取得内容**: 決済金額、手数料、入金予定日等

#### 9. 電子マネー端末（Suica、PASMO、楽天Edy等）
- **データ取得方法**: CSV取り込み
- **実装手順**:
  1. 各電子マネー事業者の管理サイトにログイン
  2. CSVダウンロード
  3. RPAツール（UiPath、WinActor等）で自動化可能
- **自動化**: Seleniumなどでブラウザ操作を自動化

#### 10. QRコード決済（PayPay、LINE Pay、楽天ペイ、d払い等）
- **データ取得方法**: API連携
- **実装手順**:
  1. 各QR決済事業者の加盟店APIを利用
  2. PayPay: https://developer.paypay.ne.jp/
  3. LINE Pay: LINE for Business API
  4. 楽天ペイ: 楽天ペイ加盟店API
- **APIエンドポイント**: `/api/payment/qr/transactions`

#### 11. デビットカード決済
- **データ取得方法**: API連携
- **実装手順**: クレジットカード決済と同じAPI経由で取得
- **備考**: 決済種別フィールドで判別

#### 12. ギフトカード・商品券・プリペイドカード
- **データ取得方法**: 手動入力またはAPI連携
- **実装手順**:
  - 自社発行: 管理システムAPI連携
  - 他社発行: 手動入力または日次集計

#### 13. ポイント決済・ポイント充当
- **データ取得方法**: API連携
- **対応サービス**: Tポイント、dポイント、Pontaポイント等
- **実装手順**:
  1. ポイントシステムAPI認証
  2. APIエンドポイント: `/api/loyalty/point-transactions`
  3. ポイント利用額を売上として計上

#### 14. 後払い決済サービス（Paidyなど）
- **データ取得方法**: API連携
- **実装手順**:
  1. Paidy、atone等のBNPL事業者API連携
  2. APIエンドポイント: `/api/payment/bnpl/transactions`
  3. 決済確定日ベースで売上計上

---

### オンライン・デリバリー（8チャネル）

#### 15. 自社ECサイト・ネットショップ
- **データ取得方法**: API連携
- **対応プラットフォーム**: Shopify、BASE、STORES、カラーミーショップ等
- **実装手順**:
  1. ECプラットフォームのAPI認証
  2. Shopify: Admin API
  3. BASE: Apps API
  4. Webhook対応で即時反映も可能

#### 16. Uber Eats
- **データ取得方法**: API連携
- **実装手順**:
  1. Uber Eats Restaurant Manager API
  2. ドキュメント: https://developer.uber.com/docs/eats
  3. 日次売上レポート自動取得

#### 17. 出前館
- **データ取得方法**: CSV取り込み
- **実装手順**:
  1. 出前館管理画面からCSVエクスポート
  2. RPAツールで自動化可能
  3. 日次バッチ処理で取り込み

#### 18. menu
- **データ取得方法**: API連携
- **実装手順**:
  1. menu加盟店向けAPI連携
  2. 日次売上データ自動取得

#### 19. Wolt
- **データ取得方法**: API連携
- **実装手順**:
  1. Wolt Partner API連携
  2. APIエンドポイント: `/api/wolt/orders`
  3. 日次売上レポート自動取得

#### 20. 楽天デリバリー
- **データ取得方法**: CSV取り込み
- **実装手順**:
  1. 楽天デリバリー管理画面からCSVダウンロード
  2. 自動取り込み処理

#### 21. LINEデリバリー
- **データ取得方法**: API連携
- **実装手順**:
  1. LINE for Business API連携
  2. 注文・売上データ取得

#### 22. 自社デリバリーシステム（電話・FAX注文含む）
- **データ取得方法**: API連携または手動入力
- **実装手順**:
  1. 自社開発システムのAPI連携
  2. 電話注文は手動入力
  3. 配達管理システムと連携

---

### 予約・事前決済（3チャネル）

#### 23. テイクアウト予約システム
- **データ取得方法**: API連携
- **実装手順**:
  1. テイクアウト予約システムAPI連携
  2. APIエンドポイント: `/api/takeout/reservations`
  3. 予約時決済または受取時決済の両対応

#### 24. 席予約システム（ぐるなび、食べログ、ホットペッパー等）
- **データ取得方法**: API連携
- **実装手順**:
  1. ぐるなび: https://api.gnavi.co.jp/api/manual/
  2. 食べログ: 加盟店向けAPI
  3. ホットペッパー: リクルートAPI
  4. 予約時事前決済分を取得

#### 25. 事前決済・前売りチケット
- **データ取得方法**: API連携
- **実装手順**:
  1. PassMarket、Peatix等のチケット販売システムAPI連携
  2. チケット販売データ取得

---

### サブスク・定期購入（3チャネル）

#### 26. 月額制サブスクリプション
- **データ取得方法**: API連携
- **対応サービス**: Stripe、PAY.JP等
- **実装手順**:
  1. サブスク決済プラットフォームAPI連携
  2. APIエンドポイント: `/api/subscription/billing`
  3. 月次課金日に自動計上

#### 27. 定期購入・頒布会
- **データ取得方法**: API連携
- **実装手順**:
  1. 自社ECシステムまたはサブスク管理システムAPI連携
  2. 配送実績ベースで売上計上

#### 28. 会員制サービス
- **データ取得方法**: API連携
- **実装手順**:
  1. 会員管理システムAPI連携
  2. APIエンドポイント: `/api/membership/transactions`
  3. 入会金、年会費、月会費等を自動取得

---

### 法人・特殊販売（4チャネル）

#### 29. ケータリング売上
- **データ取得方法**: 手動入力
- **実装手順**:
  1. 受注管理システムから案件単位で入力
  2. 見積・受注・売上のステータス管理
  3. 案件完了時に売上計上

#### 30. 企業向け仕出し・宅配弁当
- **データ取得方法**: API連携
- **実装手順**:
  1. 法人向け受注システムAPI連携
  2. APIエンドポイント: `/api/corporate/orders`
  3. 定期配送と都度注文の両対応
  4. 請求書払いにも対応

#### 31. 卸売・業務用販売
- **データ取得方法**: CSV取り込み
- **実装手順**:
  1. 基幹システム（販売管理システム）からCSVエクスポート
  2. 得意先別売上集計
  3. 自動取り込みバッチ処理

#### 32. イベント出店（キッチンカー、催事等）
- **データ取得方法**: 手動入力
- **実装手順**:
  1. モバイルPOSまたは現金売上を日次で手入力
  2. イベント別に売上集計
  3. イベント情報（名称、場所、期間）も記録

---

### その他（5チャネル）

#### 33. 通信販売（電話・FAX注文）
- **データ取得方法**: 手動入力
- **実装手順**:
  1. 電話・FAX受注を受注管理システムに手入力
  2. 自動音声応答（IVR）システム連携も可能

#### 34. ソーシャルコマース（Instagram、LINEショッピング等）
- **データ取得方法**: API連携
- **実装手順**:
  1. Instagram Shopping: Meta Commerce API
  2. ドキュメント: https://developers.facebook.com/docs/commerce-platform
  3. LINEショッピング: LINE for Business API

#### 35. クラウドファンディング・先行販売
- **データ取得方法**: CSV取り込み
- **実装手順**:
  1. Makuake、CAMPFIRE等のプラットフォームからCSVダウンロード
  2. プロジェクト単位で管理
  3. 支援確定時に売上計上

#### 36. 自社アプリ内決済
- **データ取得方法**: API連携
- **実装手順**:
  1. App Store、Google PlayのAPI連携
  2. APIエンドポイント: `/api/app/purchases`
  3. アプリ内課金データ自動取得

#### 37. 掛け売り・ツケ払い（法人向け請求書払い等）
- **データ取得方法**: CSV取り込み
- **実装手順**:
  1. 販売管理システムまたは会計システムから請求データ取得
  2. 入金消込と連動
  3. 請求書発行時または入金時に売上計上

---

## 実装の優先順位

### フェーズ1: 高優先度（API連携可能なチャネル）
1. POSレジ（クラウド型）
2. クレジットカード決済
3. QRコード決済
4. 自社ECサイト
5. Uber Eats
6. サブスクリプション

### フェーズ2: 中優先度（CSV取り込み）
1. POSレジ（オンプレミス型）
2. 電子マネー
3. 出前館
4. 卸売・業務用販売

### フェーズ3: 低優先度（手動入力）
1. 手売り
2. ケータリング
3. イベント出店
4. 通信販売

---

## セキュリティ考慮事項

1. **API認証情報の管理**
   - 環境変数または暗号化されたシークレット管理システムで保管
   - AWS Secrets Manager、Azure Key Vault等の利用を推奨

2. **通信の暗号化**
   - HTTPS/TLS必須
   - API通信は全て暗号化

3. **データの保護**
   - 個人情報を含むデータは暗号化保存
   - アクセスログの記録

4. **定期的な認証情報のローテーション**
   - APIキーは定期的に更新
   - OAuth2.0トークンのリフレッシュ

---

## トラブルシューティング

### API連携が失敗する場合
1. API認証情報を確認
2. APIキーの有効期限を確認
3. レート制限を確認
4. エンドポイントURLを確認
5. ログを確認してエラーメッセージを確認

### CSVインポートが失敗する場合
1. CSVフォーマットを確認
2. 文字コードを確認（UTF-8、Shift-JIS等）
3. ファイルパスを確認
4. ファイルアクセス権限を確認

### データの不整合が発生する場合
1. タイムゾーンの設定を確認
2. 売上計上タイミングを確認（注文時 vs 決済時 vs 入金時）
3. 重複データの除外処理を確認

---

## 今後の拡張

- AI/機械学習による売上予測
- リアルタイムダッシュボード
- アラート機能（異常値検知）
- レポート自動生成
- 多店舗管理機能
